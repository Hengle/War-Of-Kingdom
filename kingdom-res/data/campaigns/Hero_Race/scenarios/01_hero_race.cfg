# scenario是场景块标签。
[scenario]

	# 本场景标识。注意下二楼[campaign]标签中的first_scenario字段
	id=hero_race
	# 本场景胜利结束后下一场景。群雄争霸只一个场景，结束就没了
	next_scenario=null
    
	# 本场景叫什么：群雄争霸
	name=_"race of hero"
	# 本场景使用到的地图
	map_data="{campaigns/Hero_Race/maps/sanguo}"
	# 本场景限定回合数。-1表示不限回合
	turns=-1
	
	#card_mode = yes
	maximal_defeated_activity = 0
    
	# 一天内分哪些时段。在不同时段不同兵种部队能力可能有不同表现。像守序单位在白天有25%加成
	# 第一时段：黎明
	{DAWN}
	# 第二时段：白天（早上）
	{MORNING}
	# 第三时段：白天（下午）
	{AFTERNOON}
	# 第四时段：黄昏
	{DUSK}
	# 第五时段：晚上（前半夜）
	{FIRST_WATCH}
	# 第六时段：晚上（后半夜）
	{SECOND_WATCH}
    
	# 游戏中使用到的背景音乐  
	[music]
    	name = legends_of_the_north.ogg
    [/music]
    {APPEND_MUSIC transience.ogg}
    {APPEND_MUSIC underground.ogg}
    {APPEND_MUSIC elvish-theme.ogg}
    {APPEND_MUSIC revelation.ogg}
  
	# 定义一个事件，触发时机：prestart，初始化场景时被执行
	[event]
		name=prestart
		
		# 定义本场景胜利条件和失败条件. (它们只是提示用，不会作为判断条件）
		[objectives]
			[objective]
				description= _"Defeat all sides"
				condition=win
			[/objective]
			[objective]
				description= _"No city you holded"
				condition=lose
			[/objective]
		[/objectives]
	[/event]

  
	# 接下开始定义势力。势力，就是类似魏、吴、蜀。  
	[side]
		# 势力编号。它必须从1始，逐1增
		side=1
		
		{PLAYER_IF 12}
			# “选择玩家”中选择了[player]...side=1[/player]后就会进入这里，一旦选择那它就是玩家
			# 是否使用战争黑幕。$指示这是一个全局变量，player.shroud不在if条件中，需要加$
			shroud=$player.shroud
			# 是否使用战争迷雾。
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			# 控制：玩家
			controller=human
		{PLAYER_ELSE}
			# “选择玩家”时玩家没有选择该势力，那就是作为ai势力
			# 控制：ai
			controller=ai
		{PLAYER_ENDIF_ELSE}
			
		# 势力领袖武将
		leader=12
		id=machao
		
		# 航海文明。不定义时默认是0，这里定义只是说了说明
		navigation=0
        
        flag="flags/loyalist-flag-1.png:150,flags/loyalist-flag-2.png:150,flags/loyalist-flag-3.png:150,flags/loyalist-flag-4.png:150"
        
		# 弥补AI不足，让AI每回合有更多金和一开始就能招3级兵
		{PLAYER_IF 12}
			# 玩家选择了该势力，初始金100
			gold=100
			# 每回合基本收入0
			income=0
			feature=(horseman, 4, 36), (horseman, 6, 49)
		{PLAYER_ELSE}
			# AI势力，初始金200
			gold=200
			# 每回合基本收入150
			income=150
			feature=(horseman, 3, 36), (horseman, 5, 49)
		{PLAYER_ENDIF_ELSE}		
		
		build = wall, market, tower
		
		# 在(19,2)坐标处放置一个城市, 该城市属于side=1，城市编号1, 城市序号125（它和武将被统一编号）
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_MID 1 1 city1 19 2 125}
		[+artifical]
			mayor = 201
			# 城市一开始“空闲武将”
			service_heros=2,48,113,146,159,199,200,201
			# 城市一开始“在野武将”
			wander_heros=170
			# 属于该城市的经济区
			economy_area=(25,4)
			# 该城市辖区（左上角x坐标，左上角y坐标，宽度，高度）
			district=(17,1,5,4)
		[/artifical]
		# 在(19,4）坐标处放置一只部队，兵种commander5，部队主将：12
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 1 (commander5) 19 4 (12)}
	[/side]
    
	#{STARTING_VILLAGES 1 7}
    
	[side]
		side=2
		
		{PLAYER_IF 136}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=150
		{PLAYER_ENDIF_ELSE}
    
    	build = wall, market, tower
    	
		leader=136
		id=yuanshao
        
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_MID 2 2 city1 47 2 126}
		[+artifical]
			service_heros=44,78,87,119,141,142,144,155,161,163,202,204,276,277
			wander_heros=185
			economy_area=(46,5)
			district=(45,1,5,4)
		[/artifical]
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 2 (commander5) 47 4 (136)}
	[/side]
   
	#{STARTING_VILLAGES 2 4}
    
	[side]
		side=3
		
		{PLAYER_IF 3}
			shroud=$player.shroud
			fog=$player.fog	
			controller=human
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=200
		{PLAYER_ENDIF_ELSE}
		
		build = wall, market, tower
		
		leader=3
		id=caocao
		
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_HIGH 3 3 city1 58 16 128}
		[+artifical]
			service_heros=7,8,9,13,15,16,35,36,37,39,45,46,47,63,64,65,67,83,86,88,94,95,97,99,101,102,107,108,122,210
			wander_heros=17,18,19,77,79,91,92,93,96,118,269
			economy_area=(54,18)
			district=(56,14,5,5)
		[/artifical]
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 3 (commander5) 58 18 3}
	[/side]

	#{STARTING_VILLAGES 3 5}
	#{STARTING_VILLAGES_AREA 3 42 32 4} 

	[side]
		side=4
		
		{PLAYER_IF 140}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=120
		{PLAYER_ENDIF_ELSE}
		
		build = wall, market, tower
		
		leader=140
		id=yuanshu
        
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_LOW 4 4 city1 54 31 129}
		[+artifical]
			service_heros=143,153,158,166,197,198
			wander_heros=34,66,68,69,111
			economy_area=(49,29)
			district=(52,29,5,5)
		[/artifical]
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 4 (commander5) 54 33 140}
	[/side]
    
	#{STARTING_VILLAGES 4 4}
    
	[side]
		side=5
		
		leader=139
		id=sunjian

		navigation=10000
		{PLAYER_IF 139}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=200
		{PLAYER_ENDIF_ELSE}
		
		build = wall, market, tower
		
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_HIGH 5 5 city1 63 39 130}
		[+artifical]
			service_heros=0,6,14,20,21,22,23,24,25,26,27,28,29,30,41,100,115,116,156,187,188,189,191,193
			wander_heros=173,182,183,184,190,192,268,282
			economy_area=(63,36)
			district=(61,37,5,5)
		[/artifical]
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 5 (commander5) 63 41 139}
	[/side]
    
	#{STARTING_VILLAGES 5 5}
    
	[side]
		side=6

		leader=138
		id=liubiao

		{PLAYER_IF 138}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=150
		{PLAYER_ENDIF_ELSE}
        
        build = wall, market, tower
        
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_MID 6 6 city1 39 47 50}
		[+artifical]
			service_heros=1,33,40,110,145,148,149,160,171,172,177,178,179,196,278
			wander_heros=43,85
			economy_area=(40,44)
			district=(37,45,5,5)
		[/artifical]
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 6 (commander5) 39 49 138}
	[/side]
    
	#{STARTING_VILLAGES 6 6}
	#{STARTING_VILLAGES_AREA 6 13 2 4} 
    
	[side]
		side=7
		
		leader=137
		id=menghuo

		{PLAYER_IF 137}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=150
		{PLAYER_ENDIF_ELSE}

		build = wall, market, tower
		
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_MID 7 7 city1 18 47 131}
		[+artifical]
			service_heros=154,167,176,194,195,203,207
			economy_area=(23,48)
			district=(16,45,5,5)
		[/artifical]
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 7 (commander5) 18 49 137}
	[/side]
    
	#{STARTING_VILLAGES 7 4}
    
	[side]
		side=8

		leader=4
		id=liubei

		{PLAYER_IF 4}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=200
		{PLAYER_ENDIF_ELSE}        
		
		build = wall, market, tower
		
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_HIGH 8 8 city1 15 33 132}
		[+artifical]
			service_heros=5,10,11,31,32,42,58,59,60,61,80,81,82,106,162,168,209,212,213,253
			wander_heros=89,90,150,180,211,261
			economy_area=(16,37)
			district=(13,31,5,5)
		[/artifical]	
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 8 (commander5) 15 35 4}
	[/side]

	[side]
		side=9

		leader=135
		id=dongzhuo

		{PLAYER_IF 135}
			shroud=$player.shroud
			fog=$player.fog
			candidate_cards=$player.candidate_cards
			holded_cards=$player.holded_cards
			controller=human
			gold=100
			income=0
		{PLAYER_ELSE}
			controller=ai
			gold=200
			income=150
		{PLAYER_ENDIF_ELSE}        
		
		build = wall, market, tower
		
		{ANONYMITY_LOYAL_MERITORIOUS_CITY_MID 9 9 city1 3 22 134}
		[+artifical]
			service_heros=98,103,104,105,120,121,147,152,157,174,181,186,205,206,208,266
			wander_heros=117,164,165,169,175
			economy_area=(7,21)
			district=(1,20,5,5)
		[/artifical]	
		{ANONYMITY_LOYAL_MERITORIOUS_UNIT 9 (commander5) 3 24 135}
	[/side]

	[side]
		# 演艺圈势力，打这势力中部队很涨经验
		side=10
		controller=ai
		# 势力名称	
		user_team_name=_"actor"

		leader=123
		id=actor
		name= _"actor"
        
		not_recruit=footman1,bowman1,catapult1,commander1,pikeman1,mage1
		
		gold=0
		income=0
	[/side]
    
	[event]
		name=start

		[artifical]
			type = wall
			side = 2
			cityno = 2
			x,y = 44, 2
		[/artifical]
		[artifical]
			type = keep
			side = 2
			cityno = 2
			x,y = 44, 3
		[/artifical]
		
		[unit]
			# 溜二拐上场
			type=stage player
			# 部队武将：38
			heros_army=38
			# 属于势力10：演艺圈
			side=10
			# 仔细看可以发现，一直都没有定义cityno=0的城市，
			# 而这里置cityno等于0，是故意要让指向一个不存在城市，也就是说这支部队是流浪部队
			cityno=0
			#x,y=34, 28
			# 溜二拐初始出现在座标(48, 5)格子
			x,y=44, 6
		[/unit]
		[unit]
			type=famous director
			heros_army=123,124
			side=10
			cityno=0
			x,y=48, 4
		[/unit]
		
		[unit]
			type = stage player
			heros_army = 270
			side = 10
			cityno = 0
			x, y = 63, 43
		[/unit]
	[/event]

	# 挂接新回合时事件。每次新回合，要执行在野武将自荐
	[event]
		name=new turn
		first_time_only=no
		
		[recommend]
		[/recommend]
		[ai]
			selfish=no
		[/ai]
	[/event]

	# 挂接外交事件，可以同盟
	[event]
		name=diplomatism
		first_time_only=no
		[ally]
		[/ally]
	[/event]

	# 挂接溜二拐被打得退场时事件
	[event]
		name=last breath
		# [filter]是个筛选器
		[filter]
			# liuxiang
			# 快退场角色必须是溜二拐为主将部队，否则不执行以下动作
			master_hero = 38
		[/filter]
		# 这个事件不仅执行一次
		first_time_only=no
		
		[if]
			[variable]
				# 85%几率执行then块中操作, 15%几率执行[else]块中操作
				name=random
				less_than=85
			[/variable]
			[then]
				# 定义一个变量。初写mod时定义这变量目的为了简单，使用下来这种方式不行。但先暂时搁着，我是要实现这种方式的
				# 为实现同样目的，现在在用的是后面那个变量：lxword
				[set_variable]
					name=lxidx
					rand=1..6
				[/set_variable]
		
				# 定义一个变量
				[set_variable]
					# 变量名lxword，值是后面那9个字符串中一个，随机取值
					name=lxword
					rand=_"liuxiang word: 1", _"liuxiang word: 2", _"liuxiang word: 3", _"liuxiang word: 4", _"liuxiang word: 5", _"liuxiang word: 6", _"liuxiang word: 7", _"liuxiang word: 8", _"liuxiang word: 9"
				[/set_variable]
        
				# 定义一个变量
				[set_variable]
					# 变量名coor_x，值是18..39中一个数字，随机取值
					name=coor_x
					rand=18..39
				[/set_variable]
        
				# 定义一个变量
				[set_variable]
					# 变量名coor_y，值是后面那8..29中一个数字，随机取值
					name=coor_y
					rand=8..29
				[/set_variable]
#ifdef NORMAL
				# 溜二拐快退场时会干什么呢？
				# 1. 说出一句至理名言。名言内容就是lxword中内容，也就是或_"liuxiang word: 1", 或_"liuxiang word: 2"，类推
				[message]
					speaker=38
					#message= _ "liuxiang word: $lxidx"
					pop_in_fog=no
					message= $lxword
				[/message]
#endif
				# 2. 告知我退场了，自我爆炸
				[kill]
					master_hero=38
					#animate=yes
				[/kill]
        
				# 3. 他改为出现在coor_x和coor_y指定格子处
				[unit]
					type=stage player
					heros_army=38
					side=10
					cityno=0
					x,y=$coor_x, $coor_y
					attacks_left = 0
				[/unit]
			[/then]
			[else]
				# 15%几率是加入高稀屎部队
#ifdef NORMAL
				[message]
					speaker=123
					pop_in_fog=no
					message= _"You have perfect potential, Come on!"
				[/message]
				[message]
					speaker=38
					pop_in_fog=no
					message= _"I'm looking forward to it always"
				[/message]
				[message]
					speaker=123
					pop_in_fog=no
					message= _"Bitch work together!"
				[/message]
#endif				
				[kill]
					master_hero=38
				[/kill]
				# 加入高稀屎部队
				[join]
					master_hero=123
					join_hero=38
				[/join]
			[/else]
		[/if]
	[/event]

	# 挂接高稀屎被打得退场时事件
	[event]
		name=last breath
		first_time_only=no
		
		[filter]
			# gxx
			master_hero = 123
		[/filter]
		        
		[set_variable]
			name=gxxidx
			rand=1..6
		[/set_variable]
		
		[set_variable]
			name=gxxword
			rand=_"gxx word: 1", _"gxx word: 2", _"gxx word: 3", _"gxx word: 4", _"gxx word: 5", _"gxx word: 6", _"gxx word: 7", _"gxx word: 8", _"gxx word: 9"
		[/set_variable]

		[if]
			[variable]
				# 20%几率“信春哥，原地复活”
				# 80%几率在另一个地方出现
				name=random
				less_than=20
			[/variable]
			[then]
				[set_variable]
					name=coor_x
					value=$unit.x
				[/set_variable]
				[set_variable]
					name=coor_y
					value=$unit.y
				[/set_variable]
#ifdef NORMAL
				[message]
					speaker=123
					pop_in_fog=no
					message= _"Believe chun! Resurrection Man-state in-situ!"
				[/message]
#endif
			[/then]
			[else]
				[set_variable]
					name=coor_x
					rand=18..39
				[/set_variable]
				[set_variable]
					name=coor_y
					rand=8..29
				[/set_variable]
			[/else]
		[/if]		
        
		[kill]
			master_hero=123
			#animate=yes
		[/kill]
        
		# 这个部队中可能有溜二拐，如果是，复活时要出来两只部队
		[unit]
			type=famous director
			heros_army=123,124
			side=10
			cityno=0
			x,y=$coor_x, $coor_y
			attacks_left = 0
		[/unit]
		[if]
			[have_unit]
				must_heros=38
			[/have_unit]
			[then]
			[/then]
			[else]
				[unit]
					type=stage player
					heros_army=38
					side=10
					cityno=0
					x,y=$coor_x, $coor_y
					attacks_left = 0
				[/unit]
			[/else]
		[/if]
	[/event]
	
	# 挂接韩痞子被打得退场时事件
	[event]
		name=last breath
		[filter]
			master_hero = 270
		[/filter]
		first_time_only=no
		
		[set_variable]
			# 变量名coor_x，值是36..66中一个数字，随机取值
			name=coor_x
			rand=36..66
		[/set_variable]
        
		[set_variable]
			# 变量名coor_y，值是后面那14..47中一个数字，随机取值
			name=coor_y
			rand=14..47
		[/set_variable]
				
		[kill]
			master_hero=270
			# animate=yes
		[/kill]
        
		[unit]
			type=stage player
			heros_army=270
			side=10
			cityno=0
			x,y=$coor_x, $coor_y
			attacks_left = 0
		[/unit]

	[/event]

[/scenario]  